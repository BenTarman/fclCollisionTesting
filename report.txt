DESCRIBE

Calling fcl::collide function isn't thread safe because of in the collide
funciton from the looktable.

REPRODUCE the problem
how to reproduce the problem. attach the test case.



PROBLEM DESCRIPTION
shared variables: CollisionFunctionMatrirx looktable. the issue is on line 91.

where looktable is read and written.



POSSIBLE SOLUTIONS


read man page PTHREAD_ONCE;


Adding locks on operations for looktable fixes these issues (the varaible std::size_t res
is the main thing causing conflicts).

I also don't see the issue with making this variable a 'thread_local'.

I made test code for having 2 fcl objects collide in parallel. I tested this with pthreads
and openmp. For pthreads running valgrind with drd and helgrind gives no errors when
either fix is applied. For the openmp implementation drd gives no errors with these changes.
Helgrind does give
errors but they are false positives that will dissapear when recompiling gcc
with '--disable-linux-futex' (https://stackoverflow.com/questions/10641972/helgrind-valgrind-and-openmp-c-avoiding-false-positives)









